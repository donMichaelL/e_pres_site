{% extends 'dashboard/base_logged.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}



{% block title %}{{object.name}} {% endblock %}
{% block main_header %}{{object.name}} <a type="button"  href="{% url 'building_list' %}" class="btn btn-outline btn-default"><i class="fa fa-arrow-left"></i>
 Back</a>
 {% endblock %}

{% block main_content %}
<div clas="row">
  <div class="col-md-4">
    {% if object.photo %}<img src="{{object.photo.url}}" class="img-responsive"></img>
    {% else%}<img src="{% static 'img/building.jpg' %}" class="img-responsive"></img>
    {% endif %}
    <form method="POST" action="" enctype="multipart/form-data">  {% csrf_token %}
      {{form | crispy }}
      <button type="submit" class="btn btn-success" name="action">Update Building</button>
    </form>
  </div>
  <div class="col-md-8">

    <div class="row">
      <div class="col-xs-12">
        <h2 class="text-center">Floors</h2>
        {% for floor in object.floor_set.all %}
        <div class="media">
        <a class="media-left" href="{% url 'floor_detail' pk=floor.pk pk_building=object.pk %}">
          <img class="media-object img-responsive" width="60px;" src="{{floor.blueprint.url}}" alt="Generic placeholder image">
        </a>
          <div class="media-body">
            <h4 class="media-heading">
              <a href="{% url 'floor_detail' pk=floor.pk pk_building=object.pk %}">{{floor.name}}</a>
              <a href="{% url 'floor_delete' pk=floor.pk pk_building=object.pk %}" type="button" class="btn btn-danger btn-circle pull-right"><i class="fa fa-times"></i></a>
            </h4>
            <p>Number: {{floor.number}}
            Max Evacuation Time: {{floor.max_evacuation_time}}
            Number of Students: {{floor.stud_number}}</p>
          </div>
        </div>
        {% endfor%}
        <div class="text-center"><a href="{% url 'floor_new' pk=object.pk %}" class="btn btn-info">Insert New Floor</a></div>
    </div>
    <div class="col-xs-12">
      <h2 class="text-center">Experiments</h2>

      {% for test in object.experiment_set.all %}
      <div class="media">
      <a class="media-left">
        <i class="fa fa-flask fa-3x"></i>
      </a>
        <div class="media-body">
          <h4 class="media-heading">
            <a href="{{test.get_absolute_url}}?next={{object.get_absolute_url}}">{{test.name}}</a>
            <a href="{% url 'test_delete' pk=test.pk %}?next={{object.get_absolute_url}}" type="button" class="btn btn-danger btn-circle pull-right"><i class="fa fa-times"></i></a>
          </h4>
          <p>Disaster: {{test.get_disaster_display}}
          Execuation Date:  {{test.execuation_date}}</p>
        </div>
      </div>
      {% endfor%}
      <div class="text-center">

        <form method="POST" action="{% url 'test_new' %}?next={{object.get_absolute_url}}"  class="form-inline" role="form">{% csrf_token %}
          <div class="form-group">
            <input type="text" class="form-control" name="name" placeholder="Enter Experiment Name">
          </div>
          <div class="form-group">
            <select class="form-control" name="disaster">
              {% for key,value in disaster_choices %}
                 <option value="{{key}}">{{value}}</option>
                 {% endfor %}
            </select>
          </div>
          <input type="hidden" class="form-control" name="building" value="{{object.pk}}">
          <button type="submit" class="btn btn-info">Insert New Experiment</button>
        </form>

      </div>



    </div>

  </div>

</div>


{% endblock %}
