{% extends 'dashboard/base_logged.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block css_styles %}
<link href="{% static "css/leaflet.css" %}" rel="stylesheet" type="text/css">

<style>
  .extra-margin{
    margin-bottom: 20px;
  }

  .maps-blueprint {
    width: 100%;
    height: 500px;
    border: 1px solid #ccc;
    margin-bottom: 10px;
  }

  .leaflet-div-icon {
  background: transparent;
  border: none;
  }
  .leaflet-marker-icon .number{
  position: relative;
  top: -55px;
  left:-10px;
  font-size: 14px;
  width: 40px;
  text-align: center;
  }
  .leaflet-container img {
  display: block;
  margin-left: auto;
  margin-right: auto
  }
</style>
{% endblock %}


{% block title %}{{object.name}} {% endblock %}
{% block main_header %}{{object.name}}
{% if request.GET.next %}
<a type="button"  href="{{request.GET.next}}" class="btn btn-outline btn-default"><i class="fa fa-arrow-left"></i> Back</a>
{% else %}
<a type="button"  href="{% url 'test_list' %}" class="btn btn-outline btn-default"><i class="fa fa-arrow-left"></i> Back</a>
{% endif %}
 {% endblock %}


 {% block main_content %}
 <div clas="row">
   <div class="col-xs-12 text-center extra-margin">
       <i class="fa fa-flask fa-5x"></i>
   </div>
   <div class="col-xs-12">
     <form method="POST" action="" class="form-inline">  {% csrf_token %}
       {{form | crispy }}
       <br>
       <br>
       <button type="submit" class="btn btn-success" name="action">Update Experiment</button>
     </form>
   </div>

   <div class="col-xs-12">
     <h1 class="lead">{{object.building}}</h1>
     {% for floor in object.building.floor_set.all %}
     <div class="row">
       <div class="col-md-8">
         <!-- <img src="{{floor.blueprint.url}}" class="img-responsive"/> -->
         <!-- <div id="image-map"></div> -->

       </div>
       <div class="col-md-4">
         <h4 class="text-center">{{floor}}</h4>
       </div>

    </div>
    {% endfor %}
    <div id="image-map-2" class="maps-blueprint"></div>

    <div id="image-map" class="maps-blueprint"></div>


   </div>


 </div>
 {% endblock %}


{% block js %}
<script src="{% static 'js/leaflet.js' %}"></script>
<script src="{% static 'js/leaf_custom.js' %}"></script>
<script>
var map2 = L.map('image-map-2', {
  minZoom: 2,
  maxZoom: 4,
  center: [-75, 102],
  zoom: 1,
  crs: L.CRS.Simple
});

// dimensions of the image
var w = 1754,
    h = 1240,
    url = '../static/img/blueprint.jpg';

// calculate the edges of the image, in coordinate space
var southWest = map2.unproject([0, h], map2.getMaxZoom()-1);
var northEast = map2.unproject([w, 0], map2.getMaxZoom()-1);
var bounds = new L.LatLngBounds(southWest, northEast);

// add the image overlay,
// so that it covers the entire map
L.imageOverlay(url, bounds).addTo(map2);




// tell leaflet that the map is exactly as big as the image
map2.setMaxBounds(bounds);

</script>
{% endblock %}
